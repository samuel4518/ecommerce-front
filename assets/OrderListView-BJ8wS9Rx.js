import{_ as ae,r as c,a as oe,c as ne,o as se,b as $,d as r,w as ue,e,f as o,h as de,g as d,i as re,j as ie,k as S,u as L,s as pe,l as i,t as u,x as ce,m as me,y as I,v as O}from"./index-CzFEAhVX.js";const ve={class:"order-list-container"},_e={class:"page-header"},fe={class:"search-bar"},ge={class:"pagination-container"},be={key:0,class:"order-details"},we={class:"detail-section"},he={class:"detail-section"},ye={class:"order-summary"},Ve={class:"total"},Ne={key:0,class:"detail-section"},Ce={__name:"OrderListView",setup(Ae){const K=c(!1),x=c(!1),U=c(!1),w=c(!1),y=c(""),V=c(""),_=c(null),g=c(1),h=c(10),T=c(0),n=c(null),m=oe({status:"",note:""}),M=[{id:1,orderNumber:"ORD20240120001",customerName:"張小明",phone:"0912345678",address:"台北市信義區信義路五段7號",totalAmount:41900,subtotal:41400,shippingFee:500,status:"processing",createdAt:"2024-01-20 10:30:00",updatedAt:"2024-01-20 14:20:00",note:"請於週間下午配送",items:[{productName:"iPhone 15 Pro",quantity:1,price:38900},{productName:"手機保護殼",quantity:1,price:2500}]},{id:2,orderNumber:"ORD20240120002",customerName:"李小華",phone:"0923456789",address:"台北市大安區敦化南路二段201號",totalAmount:3e3,subtotal:2800,shippingFee:200,status:"paid",createdAt:"2024-01-20 11:15:00",updatedAt:"2024-01-20 11:15:00",items:[{productName:"電動咖啡磨豆機",quantity:1,price:2500},{productName:"咖啡豆",quantity:1,price:300}]}],q=ne(()=>{let a=[...M];if(y.value){const v=y.value.toLowerCase();a=a.filter(s=>s.orderNumber.toLowerCase().includes(v)||s.customerName.toLowerCase().includes(v))}if(V.value&&(a=a.filter(v=>v.status===V.value)),_.value&&_.value[0]&&_.value[1]){const v=new Date(_.value[0]),s=new Date(_.value[1]);a=a.filter(A=>{const k=new Date(A.createdAt);return k>=v&&k<=s})}T.value=a.length;const t=(g.value-1)*h.value,z=t+h.value;return a.slice(t,z)}),b=a=>a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),N=a=>a?new Date(a).toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"",P=a=>({pending:"warning",paid:"success",processing:"primary",shipped:"success",completed:"",cancelled:"info"})[a]||"",B=a=>({pending:"待付款",paid:"已付款",processing:"處理中",shipped:"已出貨",completed:"已完成",cancelled:"已取消"})[a]||a,Q=a=>{n.value=a,U.value=!0},W=a=>{m.status=a.status,m.note="",n.value=a,w.value=!0},G=async()=>{if(!m.status){O.warning("請選擇訂單狀態");return}try{x.value=!0,await new Promise(a=>setTimeout(a,1e3)),n.value&&(n.value.status=m.status,n.value.updatedAt=new Date().toISOString()),O.success("狀態更新成功"),w.value=!1}catch(a){console.error("更新失敗:",a),O.error("更新失敗，請稍後再試")}finally{x.value=!1}},C=()=>{g.value=1},H=a=>{h.value=a,g.value=1},J=a=>{g.value=a};return se(()=>{T.value=q.value.length}),(a,t)=>{const z=d("el-icon"),v=d("el-input"),s=d("el-option"),A=d("el-select"),k=d("el-date-picker"),p=d("el-table-column"),F=d("el-tag"),D=d("el-button"),X=d("el-button-group"),R=d("el-table"),Y=d("el-pagination"),f=d("el-descriptions-item"),Z=d("el-descriptions"),j=d("el-dialog"),E=d("el-form-item"),ee=d("el-form"),te=re("loading");return S(),$("div",ve,[r("div",_e,[t[10]||(t[10]=r("div",{class:"header-content"},[r("h2",null,"訂單管理")],-1)),r("div",fe,[e(v,{modelValue:y.value,"onUpdate:modelValue":t[0]||(t[0]=l=>y.value=l),placeholder:"搜索訂單編號或客戶名稱",class:"search-input",clearable:"",onClear:C,onKeyup:de(C,["enter"])},{prefix:o(()=>[e(z,null,{default:o(()=>[e(L(pe))]),_:1})]),_:1},8,["modelValue"]),e(A,{modelValue:V.value,"onUpdate:modelValue":t[1]||(t[1]=l=>V.value=l),placeholder:"訂單狀態",clearable:"",onChange:C},{default:o(()=>[e(s,{label:"待付款",value:"pending"}),e(s,{label:"已付款",value:"paid"}),e(s,{label:"處理中",value:"processing"}),e(s,{label:"已出貨",value:"shipped"}),e(s,{label:"已完成",value:"completed"}),e(s,{label:"已取消",value:"cancelled"})]),_:1},8,["modelValue"]),e(k,{modelValue:_.value,"onUpdate:modelValue":t[2]||(t[2]=l=>_.value=l),type:"daterange","range-separator":"至","start-placeholder":"開始日期","end-placeholder":"結束日期",onChange:C},null,8,["modelValue"])])]),ue((S(),ie(R,{data:q.value,style:{width:"100%"},"row-key":"id"},{default:o(()=>[e(p,{prop:"orderNumber",label:"訂單編號",width:"150"}),e(p,{prop:"customerName",label:"客戶名稱",width:"120"}),e(p,{prop:"totalAmount",label:"總金額",width:"120"},{default:o(l=>[i(" NT$ "+u(b(l.row.totalAmount)),1)]),_:1}),e(p,{prop:"status",label:"狀態",width:"100"},{default:o(l=>[e(F,{type:P(l.row.status)},{default:o(()=>[i(u(B(l.row.status)),1)]),_:2},1032,["type"])]),_:1}),e(p,{prop:"createdAt",label:"建立時間",width:"160"},{default:o(l=>[i(u(N(l.row.createdAt)),1)]),_:1}),e(p,{prop:"updatedAt",label:"更新時間",width:"160"},{default:o(l=>[i(u(N(l.row.updatedAt)),1)]),_:1}),e(p,{label:"操作",width:"200",fixed:"right"},{default:o(l=>[e(X,null,{default:o(()=>[e(D,{type:"primary",icon:L(ce),onClick:le=>Q(l.row),title:"查看詳情"},null,8,["icon","onClick"]),e(D,{type:"success",icon:L(me),onClick:le=>W(l.row),title:"更新狀態",disabled:l.row.status==="cancelled"},null,8,["icon","onClick","disabled"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[te,K.value]]),r("div",ge,[e(Y,{"current-page":g.value,"onUpdate:currentPage":t[3]||(t[3]=l=>g.value=l),"page-size":h.value,"onUpdate:pageSize":t[4]||(t[4]=l=>h.value=l),"page-sizes":[10,20,50,100],total:T.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:H,onCurrentChange:J},null,8,["current-page","page-size","total"])]),e(j,{modelValue:U.value,"onUpdate:modelValue":t[5]||(t[5]=l=>U.value=l),title:"訂單詳情",width:"800px"},{default:o(()=>[n.value?(S(),$("div",be,[r("div",we,[t[11]||(t[11]=r("h3",null,"基本信息",-1)),e(Z,{column:2,border:""},{default:o(()=>[e(f,{label:"訂單編號"},{default:o(()=>[i(u(n.value.orderNumber),1)]),_:1}),e(f,{label:"訂單狀態"},{default:o(()=>[e(F,{type:P(n.value.status)},{default:o(()=>[i(u(B(n.value.status)),1)]),_:1},8,["type"])]),_:1}),e(f,{label:"客戶名稱"},{default:o(()=>[i(u(n.value.customerName),1)]),_:1}),e(f,{label:"聯絡電話"},{default:o(()=>[i(u(n.value.phone),1)]),_:1}),e(f,{label:"送貨地址",span:2},{default:o(()=>[i(u(n.value.address),1)]),_:1}),e(f,{label:"建立時間"},{default:o(()=>[i(u(N(n.value.createdAt)),1)]),_:1}),e(f,{label:"更新時間"},{default:o(()=>[i(u(N(n.value.updatedAt)),1)]),_:1})]),_:1})]),r("div",he,[t[12]||(t[12]=r("h3",null,"商品清單",-1)),e(R,{data:n.value.items,style:{width:"100%"}},{default:o(()=>[e(p,{prop:"productName",label:"商品名稱"}),e(p,{prop:"quantity",label:"數量",width:"100"}),e(p,{prop:"price",label:"單價",width:"120"},{default:o(l=>[i(" NT$ "+u(b(l.row.price)),1)]),_:1}),e(p,{label:"小計",width:"120"},{default:o(l=>[i(" NT$ "+u(b(l.row.price*l.row.quantity)),1)]),_:1})]),_:1},8,["data"]),r("div",ye,[r("p",null,"商品總額：NT$ "+u(b(n.value.subtotal)),1),r("p",null,"運費：NT$ "+u(b(n.value.shippingFee)),1),r("p",Ve,"訂單總額：NT$ "+u(b(n.value.totalAmount)),1)])]),n.value.note?(S(),$("div",Ne,[t[13]||(t[13]=r("h3",null,"備註",-1)),r("p",null,u(n.value.note),1)])):I("",!0)])):I("",!0)]),_:1},8,["modelValue"]),e(j,{modelValue:w.value,"onUpdate:modelValue":t[9]||(t[9]=l=>w.value=l),title:"更新訂單狀態",width:"400px"},{footer:o(()=>[e(D,{onClick:t[8]||(t[8]=l=>w.value=!1)},{default:o(()=>t[14]||(t[14]=[i("取消")])),_:1}),e(D,{type:"primary",onClick:G,loading:x.value},{default:o(()=>t[15]||(t[15]=[i(" 確認 ")])),_:1},8,["loading"])]),default:o(()=>[e(ee,{model:m,"label-width":"100px"},{default:o(()=>[e(E,{label:"訂單狀態"},{default:o(()=>[e(A,{modelValue:m.status,"onUpdate:modelValue":t[6]||(t[6]=l=>m.status=l),style:{width:"100%"}},{default:o(()=>[e(s,{label:"待付款",value:"pending"}),e(s,{label:"已付款",value:"paid"}),e(s,{label:"處理中",value:"processing"}),e(s,{label:"已出貨",value:"shipped"}),e(s,{label:"已完成",value:"completed"}),e(s,{label:"已取消",value:"cancelled"})]),_:1},8,["modelValue"])]),_:1}),e(E,{label:"備註"},{default:o(()=>[e(v,{modelValue:m.note,"onUpdate:modelValue":t[7]||(t[7]=l=>m.note=l),type:"textarea",rows:3,placeholder:"請輸入狀態更新備註"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},De=ae(Ce,[["__scopeId","data-v-017945c9"]]);export{De as default};
